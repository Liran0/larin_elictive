from telegram.ext import Updater, Filters, MessageHandler,CallbackContext
from key import TOKEN
from telegram import Update, ReplyKeyboardMarkup, ReplyKeyboardRemove


def main():
    updater = Updater(
        token=TOKEN,
        use_context=True
)

    dispatcher = updater.dispatcher
    keybord_handler = MessageHandler(Filters.text('клавиатура'), keybord)
    exo_handler = MessageHandler(Filters.all, exo)
    hallo_handler = MessageHandler(Filters.text('Привет, привет'), say_hallo)

    dispatcher.add_handler(hallo_handler)
    dispatcher.add_handler(keybord_handler)
    dispatcher.add_handler(exo_handler)

    updater.start_polling()
    updater.idle()


def say_hallo(update, context):
    name = update.message.from_user.first_name
    text = update.message.text
    update.message.reply_text(text="привет")


def exo(update: Update, context: CallbackContext):
    name = update.message.from_user.first_name
    user_id = update.message.chat_id
    text = update.message.text if update.message.text else "но текста нет"
    sticker = update.message.sticker.file_unique_id
    update.message.reply_sticker(sticker=sticker)
    update.message.reply_text(text=f'Привет, {name}!\n'
                              f'Твой id: {user_id}\n'
                              f'Ты написал какой-то калл: {text}\n'
                              f'Твой стикер: {sticker}\n')


def keybord(update: Update, context: CallbackContext):
    buttons = [
        ['1', '2', '3'],
        ['привет', 'gjrf']
    ]
    keys = ReplyKeyboardMarkup
    update.message.reply_text(
        text='смотри, есть клава ',
        reply_markup=ReplyKeyboardMarkup(
            buttons,
            resize_keyboard=True

        )
    )


if __name__ == '__main__':
    main()
